services:
  civicpatch-slim:
    init: true # https://stackoverflow.com/questions/50634819/xvfb-run-hangs-in-container
    image: ghcr.io/civicpatch/civicpatch-slim:latest
    restart: unless-stopped
    environment:
      - FRIENDLY_STORAGE_HOST=${FRIENDLY_STORAGE_HOST}
      - STORAGE_ENDPOINT=${STORAGE_ENDPOINT}
      - STORAGE_ACCESS_KEY_ID=${STORAGE_ACCESS_KEY_ID}
      - STORAGE_SECRET_ACCESS_KEY=${STORAGE_SECRET_ACCESS_KEY}

      - API_CIVICPATCH_ORG_TOKEN=${API_CIVICPATCH_ORG_TOKEN}
      - API_CIVICPATCH_ORG_URL=${API_CIVICPATCH_ORG_URL}

      - LOG_LEVEL=${LOG_LEVEL:-INFO}
    # network_mode: host
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
      - ./data_source:/app/data_source
