name: "[manual] Sync data back to crudder"
on:
  workflow_dispatch:

jobs:
  sync-with-api:
    environment: env-${{ github.actor }}
    runs-on: ubuntu-latest
    steps:
      - name: Call od_sync
        env:
          API_CIVICPATCH_ORG_TOKEN: ${{ secrets.API_CIVICPATCH_ORG_TOKEN }}
          API_CIVICPATCH_ORG_URL: ${{ vars.API_CIVICPATCH_ORG_URL }}
        run: |
          curl -X POST "$API_CIVICPATCH_ORG_URL/api/admin/od_sync" \
            -H "Content-Type: application/json" \
            -H "Authorization: $API_CIVICPATCH_ORG_TOKEN" \
            --fail-with-body
